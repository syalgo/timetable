<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>2026 정보올림피아드 준비 in 세영로보틱스</title>

  <style>
    :root{
      --bg:#05070a;
      --neon:#00ff85;
      --neon2:#00d7ff;
      --warn:#ff2bd6;
      --text:#e8fff3;
      --muted:#b7c7bf;
      --border:rgba(0,255,133,.55);
      --glow:0 0 18px rgba(0,255,133,.35);

      /* JS가 조절 */
      --topScale: 1;
      --mainScale: 1;
    }

    *{box-sizing:border-box}
    html, body{height:100%}

    body{
      margin:0;
      background: radial-gradient(1200px 700px at 20% 0%, #0b1620 0%, var(--bg) 55%, #020305 100%);
      color:var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Noto Sans KR", monospace;
      overflow:hidden;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      background:
        linear-gradient(rgba(0,255,133,.06) 1px, transparent 1px) 0 0/100% 36px,
        linear-gradient(90deg, rgba(0,255,133,.05) 1px, transparent 1px) 0 0/64px 100%;
      pointer-events:none;
      opacity:.35;
    }
    body::after{
      content:"";
      position:fixed; inset:0;
      background: linear-gradient(transparent 0%, rgba(255,255,255,.03) 50%, transparent 100%);
      background-size: 100% 4px;
      pointer-events:none;
      opacity:.25;
      mix-blend-mode: overlay;
    }

    .wrap{
      width:100vw;
      height:100vh;
      padding: clamp(10px, 1.4vmin, 18px);
      display:flex;
      flex-direction:column;
      gap: clamp(8px, 1.0vmin, 12px);
    }

    /* ✅ 상단: PC에서는 한 줄 고정(넘치면 JS가 축소) */
    .topline{
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap: 10px;
      white-space:nowrap;
      overflow:hidden;
    }
    .topitem{
      font-weight:900;
      letter-spacing:.2px;
      line-height:1;
      font-size: calc(clamp(22px, 3.2vmin, 44px) * var(--topScale));
    }
    .top-title{
      justify-self:start;
      color:var(--neon);
      text-shadow: var(--glow);
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .top-session{
      justify-self:center;
      color:#ffb100;
      text-shadow: 0 0 18px rgba(255,177,0,.25);
    }
    .top-now{
      justify-self:end;
      color:var(--neon2);
      text-shadow: 0 0 14px rgba(0,215,255,.2);
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .panel{
      flex:1;
      min-height:0;
      background: linear-gradient(180deg, rgba(0,255,133,.06), rgba(0,0,0,.0));
      border:2px solid var(--border);
      border-radius:18px;
      box-shadow: var(--glow);
      padding: clamp(8px, 1.1vmin, 14px);
      display:flex;
      flex-direction:column;
      gap: clamp(8px, 1.0vmin, 12px);
    }

    .tableArea{
      flex:1;
      min-height:0;
      border-radius:14px;
      overflow:hidden;
      border:2px solid var(--border);
      background: rgba(0,0,0,.25);
    }

    table{
      width:100%;
      height:100%;
      border-collapse:collapse;
      table-layout:fixed;
    }

    /* ✅ 표 밖으로 튀어나오는 문제 방지 */
    th, td{
      border:1px solid rgba(0,255,133,.22);
      padding: 6px 10px;        /* 여백 최소 */
      text-align:center;
      font-weight:900;
      vertical-align:middle;
      overflow:hidden;          /* 핵심 */
    }

    th{
      color:var(--warn);
      background: rgba(0,0,0,.35);
      text-shadow: 0 0 12px rgba(255,43,214,.18);
      font-size: calc(clamp(20px, 2.6vmin, 40px) * var(--mainScale));
      padding: 10px 10px;
    }

    td{
      word-break:keep-all;
      line-height:1.08;
      font-size: calc(clamp(24px, 3.0vmin, 52px) * var(--mainScale));
    }

    .cellValue{
      display:block;
      width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap; /* PC: 한 줄 */
    }

    .col1{width:32%}
    .col2{width:43%}
    .col3{width:25%}

    tr.active td{
      background: rgba(0,255,133,.14);
      box-shadow: inset 0 0 0 1px rgba(0,255,133,.35);
    }

    .status-done{color:rgba(232,255,243,.55)}
    .status-plan{color:rgba(232,255,243,.9)}
    .status-live{color:var(--neon); text-shadow: var(--glow)}

    .notice{
      border:1px solid rgba(0,255,133,.25);
      border-radius:14px;
      background: rgba(0,0,0,.25);
      padding: 10px 14px;
      line-height:1.45;
      color:var(--muted);
      font-size: calc(clamp(18px, 2.2vmin, 34px) * var(--mainScale));
    }
    .notice b{color:var(--text)}

    /* ===== 모바일: 카드형(오른쪽으로 넘어가는 문제 해결) ===== */
    @media (max-width: 860px){
      body{overflow:auto;}
      .wrap{height:auto; min-height:100vh;}

      /* 모바일은 줄바꿈 허용(상단) */
      .topline{
        grid-template-columns: 1fr;
        white-space:normal;
        overflow:visible;
      }
      .top-now{justify-self:start;}
      .top-session{justify-self:start;}

      .panel{min-height:auto;}
      .tableArea{overflow:visible; border:none; background:transparent;}

      table, thead, tbody, th, tr { display:block; height:auto; }
      thead { display:none; }

      tr{
        border:1px solid rgba(0,255,133,.22);
        border-radius:14px;
        margin:10px 0;
        overflow:hidden;
        background: rgba(0,0,0,.18);
      }

      td{
        display:flex;
        justify-content:space-between;
        align-items:center;
        text-align:left;
        border:0;
        border-top:1px solid rgba(0,255,133,.18);
        gap:12px;
        padding: 12px 12px;
        line-height:1.2;
      }
      td:first-child{ border-top:0; }

      td::before{
        content: attr(data-label);
        color: rgba(232,255,243,.7);
        font-weight:900;
        flex: 0 0 92px;
      }

      /* ✅ 모바일에서 값(오른쪽)이 넘치지 않게 */
      .cellValue{
        flex: 1;
        text-align:right;
        white-space:nowrap;
        overflow:hidden;
        text-overflow:ellipsis;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topline" id="topline">
      <div class="topitem top-title" id="topTitle">2026정보올림피아드 준비 in 세영로보틱스</div>
      <div class="topitem top-session" id="sessionLabel">0회차</div>
      <div class="topitem top-now" id="nowText">Now -</div>
    </div>

    <div class="panel">
      <div class="tableArea" id="tableArea">
        <table id="mainTable">
          <thead id="thead">
            <tr>
              <th class="col1"><span class="cellValue">내용</span></th>
              <th class="col2"><span class="cellValue">시간</span></th>
              <th class="col3"><span class="cellValue">진행상황</span></th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <div class="notice" id="notice">
        <div>시험 결과에 따라 부족한 부분은 <b>평일 보충 수업 진행</b></div>
        <div>26년 1월 3일(토)은 <b>휴강!</b> 새해 복 많이 받으세요 ( __)</div>
      </div>
    </div>
  </div>

  <script>
    /** ====== 설정 ====== */
    const TIMEZONE = "Asia/Seoul";
    const START_SESSION_DATE = "2025-12-06"; // 1회차
    const OFF_DATES = new Set(["2026-01-03"]); // 휴강

    const SCHEDULE = [
      { name: "1교시", start: "16:00", end: "17:20" },
      { name: "개인 정비 및 쉬는 시간", start: "17:20", end: "17:40" },
      { name: "2교시", start: "17:40", end: "19:00" },
      { name: "저녁식사", start: "19:00", end: "19:40" },
      { name: "3교시", start: "19:40", end: "21:00" },
      { name: "개인 정비 및 쉬는 시간", start: "21:00", end: "21:20" },
      { name: "시험", start: "21:20", end: "22:00" },
    ];

    /** ====== 유틸 ====== */
    const pad2 = n => String(n).padStart(2, "0");
    const isMobile = () => window.matchMedia("(max-width: 860px)").matches;

    function nowSeoul(){
      return new Date(new Date().toLocaleString("en-US", { timeZone: TIMEZONE }));
    }
    function ymd(d){
      return `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
    }
    function parseYMD(str){
      const [y,m,dd] = str.split("-").map(Number);
      const d = nowSeoul();
      d.setFullYear(y, m-1, dd);
      d.setHours(0,0,0,0);
      return d;
    }
    function addDays(d, days){
      const x = new Date(d);
      x.setDate(x.getDate() + days);
      return x;
    }
    function nextSaturday(d){
      const day = d.getDay();
      const diff = (6 - day + 7) % 7;
      const t = addDays(d, diff);
      t.setHours(0,0,0,0);
      return t;
    }
    function dateAt(baseDate, hhmm){
      const [hh, mm] = hhmm.split(":").map(Number);
      const d = new Date(baseDate);
      d.setHours(hh, mm, 0, 0);
      return d;
    }

    // 12시간제
    function to12(h){
      const mer = (h < 12) ? "오전" : "오후";
      const h12 = ((h + 11) % 12) + 1;
      return { mer, h12 };
    }

    // ✅ PC용(공백 있음), 모바일용(압축)
    function fmtStartTime(h, m, compact){
      const { h12 } = to12(h);
      if (m === 0) return `${h12}시`;
      return compact ? `${h12}시${m}분` : `${h12}시 ${m}분`;
    }
    function fmtEndTime(startH, endH, endM, compact){
      const { h12: endH12 } = to12(endH);
      if(endH === startH){
        return `${endM}분`; // 같은 시면 40분
      }
      if(endM === 0) return `${endH12}시`;
      return compact ? `${endH12}시${endM}분` : `${endH12}시 ${endM}분`;
    }

    function fmtRangeWithDuration(startHHMM, endHHMM, compact){
      const base = nowSeoul(); base.setHours(0,0,0,0);
      const s = dateAt(base, startHHMM);
      const e = dateAt(base, endHHMM);
      const durMin = Math.round((e - s) / 60000);

      const sh = s.getHours(), sm = s.getMinutes();
      const eh = e.getHours(), em = e.getMinutes();

      const left = fmtStartTime(sh, sm, compact);
      const right = fmtEndTime(sh, eh, em, compact);

      // 모바일은 더 짧게(공백 제거)
      return compact
        ? `${left}~${right}(${durMin}분)`
        : `${left} ~ ${right}(${durMin}분)`;
    }

    function fmtNowLine(d){
      const { mer, h12 } = to12(d.getHours());
      return `Now ${d.getFullYear()}년 ${d.getMonth()+1}월 ${d.getDate()}일 ${mer} ${h12}시 ${pad2(d.getMinutes())}분 ${pad2(d.getSeconds())}초`;
    }
    function fmtRemain(ms){
      const totalSec = Math.max(0, Math.floor(ms/1000));
      const m = Math.floor(totalSec/60);
      const s = totalSec % 60;
      return `${pad2(m)}분 ${pad2(s)}초 남음`;
    }
    function sessionNumberFor(dateYMD){
      const target = parseYMD(dateYMD);
      const start = parseYMD(START_SESSION_DATE);
      if(target < start) return 0;

      let count = 0;
      for(let d = new Date(start); d <= target; d = addDays(d, 7)){
        if(!OFF_DATES.has(ymd(d))) count++;
      }
      return count;
    }

    /** ✅ 상단을 한 줄 유지: 넘치면 자동 축소 */
    function fitTopline(){
      if (isMobile()) return;
      const topline = document.getElementById("topline");

      let scale = 1.25;
      document.documentElement.style.setProperty("--topScale", String(scale));

      for(let i=0;i<16;i++){
        if (topline.scrollWidth <= topline.clientWidth) break;
        scale -= 0.05;
        if (scale < 0.70) break;
        document.documentElement.style.setProperty("--topScale", String(scale));
      }
    }

    /** ✅ 기본 메인 스케일(크게) */
    function setMainScale(){
      if (isMobile()) {
        document.documentElement.style.setProperty("--mainScale", "1");
        return;
      }
      const h = window.innerHeight;
      let s = h / 820;
      s = Math.max(1.10, Math.min(1.90, s));
      document.documentElement.style.setProperty("--mainScale", String(s));
    }

    /** ✅ PC: 남는 세로 공간을 행 높이로 분배 */
    function fitRows(){
      if (isMobile()) return;

      const tbody = document.getElementById("tbody");
      const rows = Array.from(tbody.querySelectorAll("tr"));
      if (rows.length === 0) return;

      const tableArea = document.getElementById("tableArea");
      const thead = document.getElementById("thead");
      const theadH = thead ? thead.getBoundingClientRect().height : 0;

      const areaH = tableArea.getBoundingClientRect().height;
      const available = Math.max(0, areaH - theadH);

      const per = Math.floor(available / rows.length);
      const finalH = Math.max(per, 74);

      rows.forEach(r => { r.style.height = finalH + "px"; });
    }

    /** ✅ PC: 표 안에 글자가 “튕겨 나가면” 자동으로 mainScale을 줄여서 맞춤 */
    function tableOverflows(){
      const cells = document.querySelectorAll("#mainTable th, #mainTable td");
      for (const cell of cells){
        // scroll이 client보다 크면 오버플로우
        if (cell.scrollWidth > cell.clientWidth + 1) return true;
        if (cell.scrollHeight > cell.clientHeight + 1) return true;
      }
      return false;
    }

    function fitMainScaleToTable(){
      if (isMobile()) return;

      let s = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--mainScale")) || 1;

      // 최대 20번까지 줄여가며 맞춤
      for(let i=0;i<20;i++){
        fitRows();
        if(!tableOverflows()) break;
        s -= 0.05;
        if (s < 1.00) break;
        document.documentElement.style.setProperty("--mainScale", String(s));
      }
    }

    /** ====== 렌더 ====== */
    function render(){
      const now = nowSeoul();
      document.getElementById("nowText").textContent = fmtNowLine(now);

      const todayKey = ymd(now);
      const isSat = (now.getDay() === 6);
      const isOff = OFF_DATES.has(todayKey);

      let sessionBase = isSat ? (() => { const d = new Date(now); d.setHours(0,0,0,0); return d; })()
                              : nextSaturday(now);
      if(OFF_DATES.has(ymd(sessionBase))) sessionBase = addDays(sessionBase, 7);

      const sessionNo = sessionNumberFor(ymd(sessionBase));
      document.getElementById("sessionLabel").textContent = (sessionNo > 0) ? `${sessionNo}회차` : `0회차`;

      const tbody = document.getElementById("tbody");
      tbody.innerHTML = "";

      const enableCountdown = isSat && !isOff;
      let activeIndex = -1;

      if(enableCountdown){
        const base = new Date(now); base.setHours(0,0,0,0);
        for(let i=0;i<SCHEDULE.length;i++){
          const s = dateAt(base, SCHEDULE[i].start);
          const e = dateAt(base, SCHEDULE[i].end);
          if(now >= s && now < e){ activeIndex = i; break; }
        }
      }

      const baseToday = new Date(now); baseToday.setHours(0,0,0,0);
      const compact = isMobile();

      SCHEDULE.forEach((item, idx) => {
        const tr = document.createElement("tr");
        if(idx === activeIndex) tr.classList.add("active");

        const td1 = document.createElement("td");
        td1.setAttribute("data-label", "내용");
        td1.innerHTML = `<span class="cellValue">${item.name}</span>`;

        const td2 = document.createElement("td");
        td2.setAttribute("data-label", "시간");
        td2.innerHTML = `<span class="cellValue">${fmtRangeWithDuration(item.start, item.end, compact)}</span>`;

        const td3 = document.createElement("td");
        td3.setAttribute("data-label", "진행상황");

        if(!enableCountdown){
          td3.innerHTML = `<span class="cellValue status-plan">예정</span>`;
        }else{
          const s = dateAt(baseToday, item.start);
          const e = dateAt(baseToday, item.end);
          if(now < s) td3.innerHTML = `<span class="cellValue status-plan">예정</span>`;
          else if(now >= e) td3.innerHTML = `<span class="cellValue status-done">완료</span>`;
          else td3.innerHTML = `<span class="cellValue status-live">${fmtRemain(e - now)}</span>`;
        }

        tr.appendChild(td1);
        tr.appendChild(td2);
        tr.appendChild(td3);
        tbody.appendChild(tr);
      });

      requestAnimationFrame(() => {
        setMainScale();
        fitMainScaleToTable();   // ✅ PC 오버플로우 자동 방지
        fitTopline();
      });
    }

    render();
    setInterval(render, 1000);

    window.addEventListener("resize", () => {
      requestAnimationFrame(() => {
        render();
      });
    });
  </script>
</body>
</html>
